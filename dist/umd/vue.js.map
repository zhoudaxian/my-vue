{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["\nfunction toCaption (str) {\n  if (typeof str !== 'string') throw Error('toCaption\\'s parmas must be a string')\n\n  return str.slice(0, 1).toUpperCase() + str.slice(1)\n}\n\nexport function isObject (data) {\n  return data && typeof data === 'object'\n}\n\nexport function isType (data, type) {\n  return ({}).toString.call(data) === `[object ${toCaption(type)}]`\n}\n\nexport function def (data, key, val) {\n  Object.defineProperty(data, key, {\n    enumerable: false,\n    configurable: false,\n    writable: true,\n    value: val\n  })\n}","\n\nconst methods = ['push', 'pop', 'shift', 'unshift', 'reverse', 'sort', 'splice']\n\nconst oldArrayMethods = Array.prototype\n\nexport const arrayMethods = Object.create(oldArrayMethods)\n\n\nmethods.forEach(method => {\n  arrayMethods[method] = function (...args) {\n    console.log('arrayMethods')\n    const ob = this.__ob__\n    let ret = oldArrayMethods[method].apply(this, args)\n\n    let inserted;\n\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args;\n        break;\n      case splice:\n        inserted = args.slice(2)\n      default:\n        break;\n    }\n\n    if (inserted) ob.observerArray(inserted)\n\n    return ret\n  }\n})","import { isObject, isType, def } from '../util/index'\nimport { arrayMethods } from './array.js'\n\nclass Observer {\n  constructor (data) {\n\n    // data.__ob__ = this\n    def(data, '__ob__', this)\n\n    if (Array.isArray(data)) {\n      data.__proto__ = arrayMethods\n      this.observerArray(data)\n    } else {\n      this.walk(data)\n    }\n\n  }\n  observerArray (data) {\n    data.forEach(val => {\n      observe(val)\n    })\n  }\n\n  walk (data) {\n    let keys = Object.keys(data)\n\n    keys.forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n\n}\n\nfunction defineReactive (data, key, val) {\n  observe(val)\n  Object.defineProperty(data, key, {\n    get () {\n      return val\n    },\n    set (newVal) {\n      if (newVal === val) return\n      observe(newVal)\n      val = newVal\n    }\n  })\n}\nexport function observe (data) {\n  console.log('observe', data, isType(data, 'object'))\n  if (!isObject(data)) return\n\n  return new Observer(data)\n}","import { observe } from './observer/index.js'\nexport function initState (vm) {\n  console.log('init state')\n\n  const opts = vm.$options\n\n\n  if (opts.props) {\n    initProps(vm)\n  }\n\n  if (opts.methods) {\n    initMethod(vm)\n  }\n\n  if (opts.data) {\n    initData(vm)\n  }\n\n  if (opts.computed) {\n    initComputed(vm)\n  }\n\n  if (opts.watch) {\n    initWatch(vm)\n  }\n\n\n}\n\nfunction initProps (vm) {\n  console.log('init props')\n}\n\nfunction initMethod (vm) {\n  console.log('init method')\n}\n\nfunction initData (vm) {\n  let data = vm.$options.data\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data\n\n  observe(data)\n  console.log('init data', data)\n}\n\nfunction initComputed (vm) {\n  console.log('init computed')\n}\n\nfunction initWatch (vm) {\n  console.log('init watch')\n}","\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9a-zA-Z]*`;\n\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\n\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\n\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\n\nconst attribute = /^/\n\n\n\nexport function compileToFunction (templete) {\n\n\n  return function render () {\n\n  }\n}\n\n","import { initState } from './state'\nimport { compileToFunction } from './compiler/index'\n\n\n\nexport function initMixin (Vue) {\n  Vue.prototype._init = function (options) {\n    console.log('_init')\n    const vm = this\n    vm.$options = options\n\n\n    initState(vm);\n\n    if (vm.$options.el) vm.$mount(vm.$options.el)\n\n\n  }\n\n\n  Vue.prototype.$mount = function (el) {\n    const vm = this\n    const opts = vm.$options\n    el = document.querySelector(el)\n\n    let templete\n    let render\n    // priority  render-> template -> el\n    if (opts.render) {\n      render = opts.render\n    } else if (opts.templete) {\n      templete = opts.templete\n      render = compileToFunction(templete)\n      opts.render = render\n    } else {\n      templete = el.outerHTML\n    }\n\n\n\n  }\n}\n\n\n","import { initMixin } from './init'\n// import { initMixin } from './init'\n\nfunction Vue (options) {\n  // console.log(options)\n  this._init(options)\n}\n\ninitMixin(Vue)\n\n\n\nexport default Vue\n"],"names":["toCaption","str","Error","slice","toUpperCase","isObject","data","isType","type","toString","call","def","key","val","Object","defineProperty","enumerable","configurable","writable","value","methods","oldArrayMethods","Array","prototype","arrayMethods","create","forEach","method","args","console","log","ob","__ob__","ret","apply","inserted","splice","observerArray","Observer","constructor","isArray","__proto__","walk","observe","keys","defineReactive","get","set","newVal","initState","vm","opts","$options","props","initProps","initMethod","initData","computed","initComputed","watch","initWatch","_data","compileToFunction","templete","render","initMixin","Vue","_init","options","el","$mount","document","querySelector","outerHTML"],"mappings":"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"}